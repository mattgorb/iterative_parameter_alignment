(transformers) luffy:~/matching_lin_codim$ python mnist_example2.py --baseline=True --randinit_baseline=True --epochs=100 --gpu=6
/s/luffy/b/nobackup/mgorb/anaconda/envs/transformers/lib/python3.7/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /s/luffy/b/nobackup/mgorb/anaconda/envs/transformers/lib/python3.7/site-packages/torchvision/image.so: undefined symbol: _ZN3c106detail19maybe_wrap_dim_slowEllb
  warn(f"Failed to load image Python extension: {e}")
=> Freezing model weights
==> No gradient to conv1.weight
==> No gradient to conv2.weight
==> No gradient to fc1.weight
==> No gradient to fc2.weight
Fitting model...
Epoch 1
Saving model with train loss 0.338218092918396
Test set: Average loss: 0.1022, Accuracy: 9678/10000 (97%)
Epoch 2
Saving model with train loss 0.10103166848421097
Test set: Average loss: 0.1029, Accuracy: 9664/10000 (97%)
Epoch 3
Saving model with train loss 0.08495482057332993
Test set: Average loss: 0.0881, Accuracy: 9704/10000 (97%)
Epoch 4
Saving model with train loss 0.07655313611030579
Test set: Average loss: 0.0878, Accuracy: 9738/10000 (97%)
Epoch 5
Saving model with train loss 0.06949739158153534
Test set: Average loss: 0.0625, Accuracy: 9791/10000 (98%)
Epoch 6
Saving model with train loss 0.06312927603721619
Test set: Average loss: 0.0663, Accuracy: 9789/10000 (98%)
Epoch 7
Saving model with train loss 0.06062111631035805
Test set: Average loss: 0.0688, Accuracy: 9784/10000 (98%)
Epoch 8
Saving model with train loss 0.060126692056655884
Test set: Average loss: 0.0714, Accuracy: 9776/10000 (98%)
Epoch 9
Saving model with train loss 0.057155828922986984
Test set: Average loss: 0.0682, Accuracy: 9777/10000 (98%)
Epoch 10
Saving model with train loss 0.05644061043858528
Test set: Average loss: 0.0596, Accuracy: 9809/10000 (98%)
Epoch 11
Epoch 12
Saving model with train loss 0.05267464742064476
Test set: Average loss: 0.0605, Accuracy: 9807/10000 (98%)
Epoch 13
Saving model with train loss 0.052436020225286484
Test set: Average loss: 0.0634, Accuracy: 9785/10000 (98%)
Epoch 14
Epoch 15
Saving model with train loss 0.05037464201450348
Test set: Average loss: 0.0797, Accuracy: 9728/10000 (97%)
Epoch 16
Epoch 17
Saving model with train loss 0.04991822689771652
Test set: Average loss: 0.0540, Accuracy: 9837/10000 (98%)
Epoch 18
Saving model with train loss 0.049908071756362915
Test set: Average loss: 0.0524, Accuracy: 9828/10000 (98%)
Epoch 19
Saving model with train loss 0.04814458638429642
Test set: Average loss: 0.0725, Accuracy: 9765/10000 (98%)
Epoch 20
Epoch 21
Saving model with train loss 0.04671066254377365
Test set: Average loss: 0.0533, Accuracy: 9823/10000 (98%)
Epoch 22
Epoch 23
Saving model with train loss 0.046451348811388016
Test set: Average loss: 0.0552, Accuracy: 9825/10000 (98%)
Epoch 24
Saving model with train loss 0.04577815905213356
Test set: Average loss: 0.0746, Accuracy: 9768/10000 (98%)
Epoch 25
Epoch 26
Saving model with train loss 0.04472748935222626
Test set: Average loss: 0.0620, Accuracy: 9795/10000 (98%)
Epoch 27
Saving model with train loss 0.043784379959106445
Test set: Average loss: 0.0483, Accuracy: 9844/10000 (98%)
Epoch 28
Saving model with train loss 0.040354013442993164
Test set: Average loss: 0.0482, Accuracy: 9851/10000 (99%)
Epoch 29
Epoch 30
Epoch 31
Saving model with train loss 0.04034523293375969
Test set: Average loss: 0.0602, Accuracy: 9812/10000 (98%)
Epoch 32
Saving model with train loss 0.038709819316864014
Test set: Average loss: 0.0532, Accuracy: 9846/10000 (98%)
Epoch 33
Saving model with train loss 0.036972951143980026
Test set: Average loss: 0.0467, Accuracy: 9855/10000 (99%)
Epoch 34
Epoch 35
Saving model with train loss 0.03650814667344093
Test set: Average loss: 0.0477, Accuracy: 9855/10000 (99%)
Epoch 36
Saving model with train loss 0.03524555638432503
Test set: Average loss: 0.0515, Accuracy: 9843/10000 (98%)
Epoch 37
Epoch 38
Saving model with train loss 0.033608946949243546
Test set: Average loss: 0.0471, Accuracy: 9848/10000 (98%)
Epoch 39
Saving model with train loss 0.03173304721713066
Test set: Average loss: 0.0447, Accuracy: 9853/10000 (99%)
Epoch 40
Saving model with train loss 0.029550500214099884
Test set: Average loss: 0.0404, Accuracy: 9875/10000 (99%)
Epoch 41
Epoch 42
Saving model with train loss 0.02757052518427372
Test set: Average loss: 0.0452, Accuracy: 9864/10000 (99%)
Epoch 43
Epoch 44
Saving model with train loss 0.02754402533173561
Test set: Average loss: 0.0384, Accuracy: 9876/10000 (99%)
Epoch 45
Saving model with train loss 0.02596244215965271
Test set: Average loss: 0.0371, Accuracy: 9873/10000 (99%)
Epoch 46
Epoch 47
Saving model with train loss 0.025347387418150902
Test set: Average loss: 0.0367, Accuracy: 9884/10000 (99%)
Epoch 48
Saving model with train loss 0.023389771580696106
Test set: Average loss: 0.0401, Accuracy: 9883/10000 (99%)
Epoch 49
Saving model with train loss 0.023315317928791046
Test set: Average loss: 0.0375, Accuracy: 9883/10000 (99%)
Epoch 50
Saving model with train loss 0.020347973331809044
Test set: Average loss: 0.0349, Accuracy: 9879/10000 (99%)
Epoch 51
Epoch 52
Saving model with train loss 0.019209610298275948
Test set: Average loss: 0.0329, Accuracy: 9896/10000 (99%)
Epoch 53
Saving model with train loss 0.018506288528442383
Test set: Average loss: 0.0354, Accuracy: 9890/10000 (99%)
Epoch 54
Saving model with train loss 0.017954109236598015
Test set: Average loss: 0.0341, Accuracy: 9895/10000 (99%)
Epoch 55
Saving model with train loss 0.01681046560406685
Test set: Average loss: 0.0350, Accuracy: 9890/10000 (99%)
Epoch 56
Saving model with train loss 0.015421987511217594
Test set: Average loss: 0.0359, Accuracy: 9881/10000 (99%)
Epoch 57
Saving model with train loss 0.015415629372000694
Test set: Average loss: 0.0371, Accuracy: 9881/10000 (99%)
Epoch 58
Saving model with train loss 0.01437290571630001
Test set: Average loss: 0.0312, Accuracy: 9895/10000 (99%)
Epoch 59
Saving model with train loss 0.01292480155825615
Test set: Average loss: 0.0340, Accuracy: 9893/10000 (99%)
Epoch 60
Epoch 61
Saving model with train loss 0.012812784872949123
Test set: Average loss: 0.0303, Accuracy: 9902/10000 (99%)
Epoch 62
Saving model with train loss 0.012014910578727722
Test set: Average loss: 0.0323, Accuracy: 9893/10000 (99%)
Epoch 63
Saving model with train loss 0.01181674376130104
Test set: Average loss: 0.0307, Accuracy: 9897/10000 (99%)
Epoch 64
Saving model with train loss 0.010789584368467331
Test set: Average loss: 0.0328, Accuracy: 9891/10000 (99%)
Epoch 65
Saving model with train loss 0.0103587182238698
Test set: Average loss: 0.0310, Accuracy: 9897/10000 (99%)
Epoch 66
Saving model with train loss 0.01025456003844738
Test set: Average loss: 0.0335, Accuracy: 9892/10000 (99%)
Epoch 67
Saving model with train loss 0.009720969945192337
Test set: Average loss: 0.0365, Accuracy: 9879/10000 (99%)
Epoch 68
Saving model with train loss 0.009630692191421986
Test set: Average loss: 0.0288, Accuracy: 9900/10000 (99%)
Epoch 69
Saving model with train loss 0.009359602816402912
Test set: Average loss: 0.0298, Accuracy: 9904/10000 (99%)
Epoch 70
Saving model with train loss 0.00914776511490345
Test set: Average loss: 0.0310, Accuracy: 9905/10000 (99%)
Epoch 71
Saving model with train loss 0.008990026079118252
Test set: Average loss: 0.0302, Accuracy: 9911/10000 (99%)
Epoch 72
Saving model with train loss 0.008773756213486195
Test set: Average loss: 0.0304, Accuracy: 9907/10000 (99%)
Epoch 73
Saving model with train loss 0.008556806482374668
Test set: Average loss: 0.0301, Accuracy: 9903/10000 (99%)
Epoch 74
Epoch 75
Saving model with train loss 0.008114665746688843
Test set: Average loss: 0.0302, Accuracy: 9907/10000 (99%)
Epoch 76
Saving model with train loss 0.008110974915325642
Test set: Average loss: 0.0306, Accuracy: 9905/10000 (99%)
Epoch 77
Saving model with train loss 0.007747731637209654
Test set: Average loss: 0.0293, Accuracy: 9905/10000 (99%)
Epoch 78
Epoch 79
Epoch 80
Saving model with train loss 0.007731166668236256
Test set: Average loss: 0.0301, Accuracy: 9910/10000 (99%)
Epoch 81
Saving model with train loss 0.007584462407976389
Test set: Average loss: 0.0297, Accuracy: 9899/10000 (99%)
Epoch 82
Saving model with train loss 0.007485531270503998
Test set: Average loss: 0.0302, Accuracy: 9900/10000 (99%)
Epoch 83
Saving model with train loss 0.0072985501028597355
Test set: Average loss: 0.0294, Accuracy: 9909/10000 (99%)
Epoch 84
Epoch 85
Epoch 86
Saving model with train loss 0.007120034191757441
Test set: Average loss: 0.0294, Accuracy: 9906/10000 (99%)
Epoch 87
Epoch 88
Saving model with train loss 0.006981200072914362
Test set: Average loss: 0.0290, Accuracy: 9909/10000 (99%)
Epoch 89
Saving model with train loss 0.00690411776304245
Test set: Average loss: 0.0309, Accuracy: 9902/10000 (99%)
Epoch 90
Epoch 91
Saving model with train loss 0.006853947415947914
Test set: Average loss: 0.0298, Accuracy: 9904/10000 (99%)
Epoch 92
Saving model with train loss 0.006744463462382555
Test set: Average loss: 0.0301, Accuracy: 9902/10000 (99%)
Epoch 93
Saving model with train loss 0.006718622054904699
Test set: Average loss: 0.0292, Accuracy: 9903/10000 (99%)
Epoch 94
Saving model with train loss 0.006674814037978649
Test set: Average loss: 0.0302, Accuracy: 9902/10000 (99%)
Epoch 95
Saving model with train loss 0.006528317462652922
Test set: Average loss: 0.0307, Accuracy: 9899/10000 (99%)
Epoch 96
Epoch 97
Epoch 98
Saving model with train loss 0.0064625246450304985
Test set: Average loss: 0.0295, Accuracy: 9906/10000 (99%)
Epoch 99
Saving model with train loss 0.00633197883144021
Test set: Average loss: 0.0298, Accuracy: 9905/10000 (99%)
Epoch 100
Saving model with train loss 0.006295200902968645
Test set: Average loss: 0.0299, Accuracy: 9907/10000 (99%)
(transformers) luffy:~/matching_lin_codim$
